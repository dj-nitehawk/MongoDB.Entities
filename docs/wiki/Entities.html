<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Define entities | MongoDB.Entities </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Define entities | MongoDB.Entities ">
      <meta name="description" content="A data access library for MongoDB with an elegant api, LINQ support and built-in entity relationship management.">
      
      <link rel="icon" href="../images/favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/icon.png" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="define-entities">Define entities</h1>

<p>add the import statement and create your entities by inheriting the <code>Entity</code> base class.</p>
<pre><code class="lang-csharp">using MongoDB.Entities;

public class Book : Entity
{
    public string Title { get; set; }
}
</code></pre>
<h1 id="ignore-properties">Ignore properties</h1>
<p>if there are some properties on entities you don't want persisted to mongodb, simply use the <code>IgnoreAttribute</code>.
you can prevent null/default values from being stored with the use of <code>IgnoreDefaultAttribute</code>.</p>
<pre><code class="lang-csharp">public class Book : Entity
{
    [Ignore] 
    public string DontSaveMe { get; set; }

    [IgnoreDefault] 
    public int SomeNumber { get; set; }
}
</code></pre>
<h1 id="customize-field-names">Customize field names</h1>
<p>you can set the field names of the documents stored in mongodb using the <code>FieldAttribute</code> like so:</p>
<pre><code class="lang-csharp">public class Book
{
    [Field(&quot;book_name&quot;)]
    public string Title { get; set; }
}
</code></pre>
<h1 id="customize-collection-names">Customize collection names</h1>
<p>by default, mongodb collections will use the names of the entity classes. you can customize the collection names by decorating your entities with the <code>CollectionAttribute</code> as follows:</p>
<pre><code class="lang-csharp">[Collection(&quot;Writer&quot;)]
public class Author : Entity
{
    ...
}
</code></pre>
<h1 id="optional-auto-managed-properties">Optional auto-managed properties</h1>
<p>there are 2 optional interfaces <code>ICreatedOn</code> &amp; <code>IModifiedOn</code> that you can add to entity class definitions like so:</p>
<pre><code class="lang-csharp">public class Book : Entity, ICreatedOn, IModifiedOn
{
    public string Title { get; set; }
    public DateTime CreatedOn { get; set; }
    public DateTime ModifiedOn { get; set; }
}
</code></pre>
<p>if your entity classes implements these interfaces, the library will automatically set the appropriate values so you can use them for sorting operations and other queries.</p>
<h1 id="the-ientity-interface">The IEntity interface</h1>
<p>if for whatever reason, you're unable to inherit the <code>Entity</code> base class, you can simply implement the <code>IEntity</code> interface to make your classes compatible with the library like so:</p>
<pre><code class="lang-csharp">public class Book : IEntity
{
    public string ID { get; set; } = null!;

    public object GenerateNewID()
        =&gt; ObjectId.GenerateNewId().ToString();
}
</code></pre>
<h1 id="customizing-the-id-format">Customizing the ID format</h1>
<p>the default format of the IDs automatically generated for new entities is <code>ObjectId</code>. if you'd like to change the type/format of the ID, simply override the <code>GenerateNewID</code> method of the <code>Entity</code> base class or implement the <code>IEntity</code> interface. if implementing <code>IEntity</code>, don't forget to decorate the ID property with the <code>[BsonId]</code> attribute to indicate that it's the primary key.</p>
<pre><code class="lang-csharp">public class Book : IEntity
{
    [BsonId]
    public Guid Id { get; set; } = Guid.Empty;

    public object GenerateNewID()
        =&gt; Guid.NewGuid();
}
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>the type of the ID property can be whatever type you like (given that it can be serialized by the mongo driver). however, due to a technical constraint, only the following types are supported with the <a href="Relationships-Referenced.html">referenced relationship</a> functionality:</p>
<ul>
<li>string</li>
<li>long</li>
<li>ObjectId</li>
</ul>
</div>
<!-- <h2 style="color:#cb0000">A word of warning about custom IDs</h2> -->
<div class="WARNING">
<h5>Warning</h5>
<p>it is highly recommended that you stick with <code>ObjectId</code> as it's highly unlikely it would generate duplicate IDs due to <a href="https://www.mongodb.com/blog/post/generating-globally-unique-identifiers-for-use-with-mongodb">the way it works</a>.</p>
<p>if you choose something like <code>Guid</code>, there's a possibility for duplicates to be generated and data loss could occur when using the <a href="Entities-Save.html#save-entities-partially">partial entity saving</a> operations. reason being, those operations use upserts under the hood and if a new entity is assigned the same ID as one that already exists in the database, the existing entity will get replaced by the new entity.</p>
<p>the normal save operations do not have this issue because they use inserts under the hood and if you try to insert a new entity with a duplicate ID, a duplicate key exception would be thrown due to the unique index on the ID property.</p>
<p>so you're better off sticking with <code>ObjectId</code> because the only way it could ever generate a duplicate ID is if more than 16 million entities are created at the exact moment on the exact computer with the exact same process.</p>
</div>
<h1 id="create-a-collection-explicitly">Create a collection explicitly</h1>
<pre><code class="lang-csharp">await db.CreateCollectionAsync&lt;Book&gt;(o =&gt;
{
    o.Collation = new Collation(&quot;es&quot;);
    o.Capped = true;
    o.MaxDocuments = 10000;
});
</code></pre>
<p>typically you don't need to create collections manually as they will be created automatically the first time you save an entity.
however, you'd have to create the collection like above if you need to use a custom <em><a href="https://docs.mongodb.com/manual/reference/collation/">COLLATION</a></em>, create a <em><a href="https://docs.mongodb.com/manual/core/capped-collections/">CAPPED</a></em>, or <em><a href="https://docs.mongodb.com/manual/core/timeseries-collections/">TIME SERIES</a></em> collection before you can save any entities.</p>
<div class="NOTE">
<h5>Note</h5>
<p>if a collection already exists for the specified entity type, an exception will be thrown.</p>
</div>
<h1 id="drop-a-collection">Drop a collection</h1>
<pre><code class="lang-csharp">await db.DropCollectionAsync&lt;Book&gt;();
</code></pre>

</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Developed by <a href='https://github.com/dj-nitehawk'>Đĵ ΝιΓΞΗΛψΚ</a> and <a href='https://github.com/dj-nitehawk/MongoDB.Entities/graphs/contributors'>contributors</a> / Licensed under <a href='https://github.com/dj-nitehawk/MongoDB.Entities/blob/master/LICENSE'>MIT</a> / Website generated by <a href='https://dotnet.github.io/docfx/'>DocFX</a>
        </div>
      </div>
    </footer>
  </body>
</html>
